<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive exploration of design matrices with ExploreModelMatrix • ExploreModelMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interactive exploration of design matrices with ExploreModelMatrix">
<meta property="og:description" content="ExploreModelMatrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ExploreModelMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ExploreModelMatrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ExploreModelMatrix.html">ExploreModelMatrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/csoneson/ExploreModelMatrix" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ExploreModelMatrix_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="ExploreModelMatrix_files/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="ExploreModelMatrix_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interactive exploration of design matrices with ExploreModelMatrix</h1>
                        <h4 data-toc-skip class="author">Charlotte Soneson, Federico Marini, Michael I Love, Florian Geier and Michael B Stadler</h4>
            
            <h4 data-toc-skip class="date">2021-10-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/csoneson/ExploreModelMatrix/blob/master/vignettes/ExploreModelMatrix.Rmd" class="external-link"><code>vignettes/ExploreModelMatrix.Rmd</code></a></small>
      <div class="hidden name"><code>ExploreModelMatrix.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h1>
<p><code>ExploreModelMatrix</code> is an R package for visualizing design matrices generated by the <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> R function. Provided with a sample information table and a design formula, the <code><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix()</a></code> function launches a shiny app where the user can explore the fitted values (in terms of the model coefficients) for each combination of predictor values. In addition, the app allows the user to interactively change the design formula and the reference levels of factor variables as well as drop unwanted columns from the design matrix, in order to explore the effect on the composition of the fitted values. Note that <code>ExploreModelMatrix</code> is not intended to be used to determine <em>which</em> design formula that should be used for analyzing a data set. Instead, its purpose is to assist in the interpretation of the coefficients in a given model.</p>
<p>In addition to the interactive visualization, <code>ExploreModelMatrix</code> also provides a function, <code><a href="../reference/VisualizeDesign.html">VisualizeDesign()</a></code>, for generating static visualizations.</p>
<p>In this vignette, we illustrate how the package can be used by showing examples of applying the functions to various experimental design setups. Many examples are taken from questions raised at the <a href="https://support.bioconductor.org/" class="external-link">Bioconductor support site</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/csoneson/ExploreModelMatrix" class="external-link">ExploreModelMatrix</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="interface" class="section level1">
<h1 class="hasAnchor">
<a href="#interface" class="anchor" aria-hidden="true"></a>Interface</h1>
<p>The <code><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix()</a></code> function opens a graphical interface where the user can interactively explore the provided design. This section gives an overview of what is shown in the graphical interface. A step-by-step tour is also available by clicking on the <i class="fa fa-question-circle"></i> icon in the top right of the application.</p>
<p><img src="../../../_temp/Library/ExploreModelMatrix/www/ExploreModelMatrix.jpg" width="600"></p>
<p>The sidebar contains the input controls. The design formula of interest is typed into the <code>Design formula</code> text box, and must start with the <code>~</code> symbol. It can be changed interactively while using the application. If the <code><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix()</a></code> function is called with <code>sampleData=NULL</code>, there will also be an input control allowing a tab-delimited text file with sample information to be uploaded to the application. Finally, the package contains a collection of example designs, suitable for teaching, exploration and illustration. The remaining input controls allow the user to change the reference levels of the factor variables, to drop specific columns from the design matrix, and to change the display settings of the plots.</p>
<p>The first row of the main body of the application displays the fitted values (expressed in terms of the model coefficients) for each combination of predictor values, in both figure and table form. In the next row, the full provided sample table as well as a summary are provided, and the third row displays the full design matrix as well as its rank. Panels below this display the pseudoinverse of the design matrix, a visualization of variance inflation factors, a co-occurrence matrix and the correlation among the model coefficients.</p>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor" aria-hidden="true"></a>Examples</h1>
<p>This section contains a number of examples of real designs, and shows how they can be explored with <code>ExploreModelMatrix</code>. For each example, the sample information table is printed out. Next, the <code><a href="../reference/VisualizeDesign.html">VisualizeDesign()</a></code> function is called to generate a static plot of the fitted values, in terms of the model coefficients. This is the same plot that is displayed in the top left panel of the interactive interface generated by <code><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix()</a></code>. We also provide the code for generating and (for interactive sessions) opening the interactive application with <code><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix()</a></code>.</p>
<div id="example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1" class="anchor" aria-hidden="true"></a>Example 1</h2>
<p>This example illustrates a two-factor design (genotype and treatment), where the effect of the genotype and treatment are assumed to be additive. For each genotype, two treated and two control individuals are studied. The design formula is <code>~ genotype + treatment</code>, reflecting the assumption of additivity between the two predictors. The figure generated by the <code><a href="../reference/VisualizeDesign.html">VisualizeDesign()</a></code> function, displayed below, shows the value of the linear predictor (or, for a regular linear model, the fitted values) for observations with a given combination of predictor values, in terms of the model coefficients. This can be useful in order to set up suitable contrasts. For example, we can see that testing the null hypothesis that the <code>genotypeB</code> coefficient is zero would correspond to comparing observations with genotype B and those with genotype A.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">sampleData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
                          treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   genotype treatment</span>
<span class="co">#&gt; 1        A      ctrl</span>
<span class="co">#&gt; 2        A       trt</span>
<span class="co">#&gt; 3        A      ctrl</span>
<span class="co">#&gt; 4        A       trt</span>
<span class="co">#&gt; 5        B      ctrl</span>
<span class="co">#&gt; 6        B       trt</span>
<span class="co">#&gt; 7        B      ctrl</span>
<span class="co">#&gt; 8        B       trt</span>
<span class="va">vd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VisualizeDesign.html">VisualizeDesign</a></span><span class="op">(</span>sampleData <span class="op">=</span> <span class="va">sampleData</span>, 
                      designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">genotype</span> <span class="op">+</span> <span class="va">treatment</span>, 
                      textSizeFitted <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">vd</span><span class="op">$</span><span class="va">plotlist</span><span class="op">)</span></code></pre></div>
<p><img src="ExploreModelMatrix_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix</a></span><span class="op">(</span>sampleData <span class="op">=</span> <span class="va">sampleData</span>,
                          designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">genotype</span> <span class="op">+</span> <span class="va">treatment</span><span class="op">)</span>
<span class="co">#&gt; This Font Awesome icon ('warning') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; This Font Awesome icon ('') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; The `name` provided ('hand-o-right') is deprecated in Font Awesome 5:</span>
<span class="co">#&gt; * please consider using 'hand-point-right' or 'fas fa-hand-point-right' instead</span>
<span class="co">#&gt; * use the `verify_fa = FALSE` to deactivate these messages</span>
<span class="co">#&gt; This Font Awesome icon ('question-circle fa-1g') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
</div>
<div id="example-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2" class="anchor" aria-hidden="true"></a>Example 2</h2>
<p>From <a href="https://support.bioconductor.org/p/121132/" class="external-link uri">https://support.bioconductor.org/p/121132/</a>. In this example we are considering a set of patients, each being either Resistant or Sensitive to a treatment, and each studied before (pre) and after (post) treatment. Patients have been renumbered within each response group, and patients with only pre- or post-measurements are removed. We use the design <code>~ Response + Response:ind.n + Response:Treatment</code>. As can be seen from the visualization below, this lets us easily compare e.g. post- vs pre-treatment observations within the Sensitive group (via the <code>ResponseSensitive.Treatmentpre</code> coefficient).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">sampleData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  Response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Resistant"</span>, <span class="st">"Sensitive"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span>,
  Patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
  Treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>,<span class="st">"post"</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>, 
  ind.n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     Response Patient Treatment ind.n</span>
<span class="co">#&gt; 1  Resistant       1       pre     1</span>
<span class="co">#&gt; 2  Resistant       1      post     1</span>
<span class="co">#&gt; 3  Resistant       2       pre     2</span>
<span class="co">#&gt; 4  Resistant       2      post     2</span>
<span class="co">#&gt; 5  Resistant       3       pre     3</span>
<span class="co">#&gt; 6  Resistant       3      post     3</span>
<span class="co">#&gt; 7  Resistant       4       pre     4</span>
<span class="co">#&gt; 8  Resistant       4      post     4</span>
<span class="co">#&gt; 9  Resistant       5       pre     5</span>
<span class="co">#&gt; 10 Resistant       5      post     5</span>
<span class="co">#&gt; 11 Resistant       6       pre     6</span>
<span class="co">#&gt; 12 Resistant       6      post     6</span>
<span class="co">#&gt; 13 Sensitive       8       pre     2</span>
<span class="co">#&gt; 14 Sensitive       8      post     2</span>
<span class="co">#&gt; 15 Sensitive      11       pre     5</span>
<span class="co">#&gt; 16 Sensitive      11      post     5</span>
<span class="co">#&gt; 17 Sensitive      12       pre     6</span>
<span class="co">#&gt; 18 Sensitive      12      post     6</span>
<span class="co">#&gt; 19 Sensitive      13       pre     7</span>
<span class="co">#&gt; 20 Sensitive      13      post     7</span>
<span class="co">#&gt; 21 Sensitive      14       pre     8</span>
<span class="co">#&gt; 22 Sensitive      14      post     8</span>
<span class="co">#&gt; 23 Sensitive      15       pre     9</span>
<span class="co">#&gt; 24 Sensitive      15      post     9</span>
<span class="co">#&gt; 25 Sensitive      16       pre    10</span>
<span class="co">#&gt; 26 Sensitive      16      post    10</span>
<span class="co">#&gt; 27 Sensitive      17       pre    11</span>
<span class="co">#&gt; 28 Sensitive      17      post    11</span>
<span class="co">#&gt; 29 Sensitive      18       pre    12</span>
<span class="co">#&gt; 30 Sensitive      18      post    12</span>
<span class="va">vd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VisualizeDesign.html">VisualizeDesign</a></span><span class="op">(</span>
  sampleData <span class="op">=</span> <span class="va">sampleData</span>,
  designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">Response</span> <span class="op">+</span> <span class="va">Response</span><span class="op">:</span><span class="va">ind.n</span> <span class="op">+</span> <span class="va">Response</span><span class="op">:</span><span class="va">Treatment</span>,
  textSizeFitted <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span>
<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">vd</span><span class="op">$</span><span class="va">plotlist</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="ExploreModelMatrix_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix</a></span><span class="op">(</span>
  sampleData <span class="op">=</span> <span class="va">sampleData</span>,
  designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">Response</span> <span class="op">+</span> <span class="va">Response</span><span class="op">:</span><span class="va">ind.n</span> <span class="op">+</span> <span class="va">Response</span><span class="op">:</span><span class="va">Treatment</span>
<span class="op">)</span>
<span class="co">#&gt; This Font Awesome icon ('warning') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; This Font Awesome icon ('') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; The `name` provided ('hand-o-right') is deprecated in Font Awesome 5:</span>
<span class="co">#&gt; * please consider using 'hand-point-right' or 'fas fa-hand-point-right' instead</span>
<span class="co">#&gt; * use the `verify_fa = FALSE` to deactivate these messages</span>
<span class="co">#&gt; This Font Awesome icon ('question-circle fa-1g') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<p>The design above doesn’t allow comparison between Resistant and Sensitive patients while accounting for the patient effect, since the patient is nested within the response group. If we choose to ignore the patient effect, we can fit a factorial model with the design formula <code>~ Treatment + Response</code>, as illustrated below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VisualizeDesign.html">VisualizeDesign</a></span><span class="op">(</span>sampleData <span class="op">=</span> <span class="va">sampleData</span>,
                      designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Response</span>, 
                      textSizeFitted <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">vd</span><span class="op">$</span><span class="va">plotlist</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="ExploreModelMatrix_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
</div>
<div id="example-3" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3" class="anchor" aria-hidden="true"></a>Example 3</h2>
<p>From <a href="https://support.bioconductor.org/p/80408/" class="external-link uri">https://support.bioconductor.org/p/80408/</a>. Here we are considering mice from two conditions (ctrl/ko), each measured with and without treatment with a drug (plus/minus). We use the design <code>~ 0 + batch + condition</code> (where <code>batch</code> corresponds to the mouse ID), and drop the column corresponding to <code>conditionko_minus</code> to get a full-rank design matrix.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">sampleData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ctrl_minus"</span>, <span class="st">"ctrl_plus"</span>, 
                           <span class="st">"ko_minus"</span>, <span class="st">"ko_plus"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,
  batch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     condition batch</span>
<span class="co">#&gt; 1  ctrl_minus     1</span>
<span class="co">#&gt; 2   ctrl_plus     1</span>
<span class="co">#&gt; 3    ko_minus     2</span>
<span class="co">#&gt; 4     ko_plus     2</span>
<span class="co">#&gt; 5  ctrl_minus     3</span>
<span class="co">#&gt; 6   ctrl_plus     3</span>
<span class="co">#&gt; 7    ko_minus     4</span>
<span class="co">#&gt; 8     ko_plus     4</span>
<span class="co">#&gt; 9  ctrl_minus     5</span>
<span class="co">#&gt; 10  ctrl_plus     5</span>
<span class="co">#&gt; 11   ko_minus     6</span>
<span class="co">#&gt; 12    ko_plus     6</span>
<span class="va">vd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VisualizeDesign.html">VisualizeDesign</a></span><span class="op">(</span>sampleData <span class="op">=</span> <span class="va">sampleData</span>,
                      designFormula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">condition</span>, 
                      textSizeFitted <span class="op">=</span> <span class="fl">4</span>, lineWidthFitted <span class="op">=</span> <span class="fl">20</span>, 
                      dropCols <span class="op">=</span> <span class="st">"conditionko_minus"</span><span class="op">)</span>
<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">vd</span><span class="op">$</span><span class="va">plotlist</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="ExploreModelMatrix_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExploreModelMatrix.html">ExploreModelMatrix</a></span><span class="op">(</span>sampleData <span class="op">=</span> <span class="va">sampleData</span>,
                          designFormula <span class="op">=</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">condition</span><span class="op">)</span>
<span class="co">#&gt; This Font Awesome icon ('warning') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; This Font Awesome icon ('') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="co">#&gt; The `name` provided ('hand-o-right') is deprecated in Font Awesome 5:</span>
<span class="co">#&gt; * please consider using 'hand-point-right' or 'fas fa-hand-point-right' instead</span>
<span class="co">#&gt; * use the `verify_fa = FALSE` to deactivate these messages</span>
<span class="co">#&gt; This Font Awesome icon ('question-circle fa-1g') does not exist:</span>
<span class="co">#&gt; * if providing a custom `html_dependency` these `name` checks can </span>
<span class="co">#&gt;   be deactivated with `verify_fa = FALSE`</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor" aria-hidden="true"></a>Session info</h1>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.1 (2021-08-10)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] ExploreModelMatrix_1.5.0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.7               tidyr_1.1.4              rprojroot_2.0.2         </span>
<span class="co">#&gt;  [4] digest_0.6.28            utf8_1.2.2               mime_0.12               </span>
<span class="co">#&gt;  [7] R6_2.5.1                 stats4_4.1.1             evaluate_0.14           </span>
<span class="co">#&gt; [10] highr_0.9                ggplot2_3.3.5            pillar_1.6.3            </span>
<span class="co">#&gt; [13] rlang_0.4.11             fontawesome_0.2.2        jquerylib_0.1.4         </span>
<span class="co">#&gt; [16] S4Vectors_0.31.5         DT_0.19                  rmarkdown_2.11          </span>
<span class="co">#&gt; [19] pkgdown_1.9000.9000.9000 textshaping_0.3.5        desc_1.4.0              </span>
<span class="co">#&gt; [22] shinyjs_2.0.0            stringr_1.4.0            htmlwidgets_1.5.4       </span>
<span class="co">#&gt; [25] munsell_0.5.0            shiny_1.7.1              compiler_4.1.1          </span>
<span class="co">#&gt; [28] httpuv_1.6.3             xfun_0.26                pkgconfig_2.0.3         </span>
<span class="co">#&gt; [31] systemfonts_1.0.2        BiocGenerics_0.39.2      htmltools_0.5.2         </span>
<span class="co">#&gt; [34] tidyselect_1.1.1         tibble_3.1.5             fansi_0.5.0             </span>
<span class="co">#&gt; [37] crayon_1.4.1             dplyr_1.0.7              later_1.3.0             </span>
<span class="co">#&gt; [40] MASS_7.3-54              grid_4.1.1               jsonlite_1.7.2          </span>
<span class="co">#&gt; [43] xtable_1.8-4             gtable_0.3.0             lifecycle_1.0.1         </span>
<span class="co">#&gt; [46] magrittr_2.0.1           scales_1.1.1             stringi_1.7.4           </span>
<span class="co">#&gt; [49] cachem_1.0.6             farver_2.1.0             fs_1.5.0                </span>
<span class="co">#&gt; [52] promises_1.2.0.1         limma_3.49.4             bslib_0.3.0             </span>
<span class="co">#&gt; [55] ellipsis_0.3.2           ragg_1.1.3               generics_0.1.0          </span>
<span class="co">#&gt; [58] vctrs_0.3.8              cowplot_1.1.1            tools_4.1.1             </span>
<span class="co">#&gt; [61] glue_1.4.2               purrr_0.3.4              crosstalk_1.1.1         </span>
<span class="co">#&gt; [64] fastmap_1.1.0            yaml_2.2.1               colorspace_2.0-2        </span>
<span class="co">#&gt; [67] rintrojs_0.3.0           shinydashboard_0.7.2     memoise_2.0.0           </span>
<span class="co">#&gt; [70] knitr_1.36               sass_0.4.0</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://csoneson.github.io" class="external-link external-link">Charlotte Soneson</a>, <a href="https://federicomarini.github.io" class="external-link external-link">Federico Marini</a>, <a href="https://mikelove.github.io" class="external-link external-link">Michael Love</a>, Florian Geier, <a href="https://github.com/mbstadler" class="external-link external-link">Michael Stadler</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
